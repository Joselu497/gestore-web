<div class="max-w-5xl mx-auto">
	<div class="bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg">
		<div class="flex justify-between items-center px-6 py-4 border-b border-gray-200">
			<h2 class="text-lg font-semibold text-gray-900">Productos</h2>
			<a routerLink="./save"
				class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 transition-colors px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
				<ng-icon name="heroPlus"></ng-icon>
				Crear Producto
			</a>
		</div>
		<div class="overflow-hidden p-6">
			<div class="pb-4">
				<div class="sm:max-w-xs">
					<input type="text" name="search" placeholder="Buscar..."
						class="mt-0.5 p-1.5 w-full rounded border-gray-300 shadow-sm sm:text-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 border"
						(input)="onSearchChange($event)">
				</div>
			</div>

			<div class="overflow-x-auto overflow-y-hidden">
				<table class="min-w-full divide-y-2 divide-gray-200">
					<thead class="ltr:text-left rtl:text-right">
						<tr class="*:font-medium *:text-gray-900 *:px-3 *:py-3">
							<th class="whitespace-nowrap">Nombre</th>
							<th class="whitespace-nowrap">Precio de compra</th>
							<th class="whitespace-nowrap">Precio de venta</th>
							<th class="whitespace-nowrap">Ganancia unitaria</th>
							<th class="whitespace-nowrap">% de ganancia</th>
							<th class="whitespace-nowrap"></th>
						</tr>
					</thead>

					<tbody class="divide-y divide-gray-200 bg-white">
						@if (!isLoadingResults()) {
						@for (product of products; track product.id) {
						<tr class="*:text-gray-900 *:first:font-medium *:px-2 *:py-1">
							<td class="whitespace-nowrap">{{ product.name }}</td>
							<td class="whitespace-nowrap text-end">
								{{ product.purchasePrice ? (product.purchasePrice | currency) : 'N/A' }}
							</td>
							<td class="whitespace-nowrap text-end">
								{{ product.salePrice ? (product.salePrice | currency) : 'N/A' }}
							</td>
							<td class="whitespace-nowrap text-end">
								{{ (product.salePrice - product.purchasePrice) | currency }}
							</td>
							<td class="whitespace-nowrap text-center">
								{{ ((product.salePrice - product.purchasePrice) / product.salePrice) | percent }}
							</td>
							<td class="whitespace-nowrap text-center flex gap-2">
								<a [routerLink]="['./save', product.id]"
									class="bg-blue-50 hover:bg-blue-200 p-1.5 text-blue-700 transition-colors grid size-8 place-content-center rounded">
									<ng-icon name="heroPencil" class=""></ng-icon>
								</a>
								<button (click)="onDelete(product.id)"
									class="bg-red-50 hover:bg-red-200 p-1.5 text-red-700 transition-colors grid size-8 place-content-center rounded">
									<ng-icon name="heroTrash"></ng-icon>
								</button>
							</td>
						</tr>
						}
						} @else {
						<tr>
							<td colspan="3" class="px-3 py-8 text-center">
								<div class="flex justify-center items-center">
									<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
								</div>
							</td>
						</tr>
						}

						@if (products.length === 0 && !isLoadingResults()) {
						<tr>
							<td colspan="100%" class="px-3 py-8 text-center text-gray-500">
								No se encontraron productos
							</td>
						</tr>
						}
					</tbody>
				</table>
			</div>
			<div class="mt-4">
				<app-paginator [config]="paginationConfig" (pageChange)="onPageChange($event)">
				</app-paginator>
			</div>
		</div>
	</div>
</div>